{% extends "cyano/base.html" %}

{% comment %}
Basket overview page template

Copyright (c) 2013 Gabriel Kind <gkind@hs-mittweida.de>
Hochschule Mittweida, University of Applied Sciences

Released under the MIT license
{% endcomment %}

{% load static %}
{% load templatetags %}
{% load filters %}

{% block head_title %}{{ block.super }} :: CyanoDesign{% endblock %}
{% block page_title %}CyanoDesign{% endblock %}

{% block action_icons_export %}
<li><a href="?{% makeurl queryargs 'format' 'xlsx' %}">Download model list in Excel format</a></li>
<li><a href="?{% makeurl queryargs 'format' 'json' %}">Download model list in JSON format</a></li>
<li><a href="?{% makeurl queryargs 'format' 'xml' %}">Download model list in XML format</a></li>
{{ block.super }}
{% endblock %}

{% block head %}
{{ block.super }}

<script>
$(document).ready(function() {
    $(function () {
        var dialog_delete = $("#dialog-delete");

        $(".delete-button").click(function() {
            var parent = $(this).parents("tr");

            dialog_delete.data("parent", parent);
            dialog_delete.data("pk", parent.data("pk"));
            dialog_delete.modal('show');
        });

        function updateTips(dialog, t) {
            dialog.find($(".validateTips").show());
            dialog.find($(".validateTips"))
                    .text(t)
                    .addClass("ui-state-highlight");
            setTimeout(function () {
                //t.removeClass("ui-state-highlight", 1500);
            }, 500);
        }

        function checkLength(dialog, o, n, min, max) {
            if (o.val().length > max || o.val().length < min) {
                o.addClass("ui-state-error");
                updateTips(dialog, "Length of " + n + " must be between " +
                        min + " and " + max + ".");
                return false;
            } else {
                return true;
            }
        }

        $(".validateTips").hide();

        $("#dialog-create .btn-primary").click(function () {
            $('#dialog-create form').submit();
        });

        $("#dialog-delete .btn-primary").click(function () {
            $.ajax({
                type: "POST",
                url: "{% url "cyano-design-delete" %}",
                context: document.body,
                data: { "id": dialog_delete.data("pk") }
            });

            dialog_delete.modal("hide");

            dialog_delete.data("parent").fadeOut(200, function() { $(this).remove(); });
        });
    });
});
</script>

{% endblock %}

{% block extrastyles %}
#feedback { font-size: 1.4em; }
#selectable .ui-selecting { background: #FECA40; }
#selectable .ui-selected { background: #F39814; color: white; }
#selectable { list-style-type: none; margin: 0; padding: 0; width: 60%; }
#selectable li { margin: 3px; padding: 0.4em; font-size: 1.4em; height: 18px; }

input.text { margin-bottom:12px; width:95%; padding: .4em; }
fieldset { padding:0; border:0; margin-top:25px; }
div#users-contain { width: 350px; margin: 20px 0; }
div#users-contain table { margin: 1em 0; border-collapse: collapse; width: 100%; }
div#users-contain table td, div#users-contain table th { border: 1px solid #eee; padding: .6em 10px; text-align: left; }
.ui-dialog .ui-state-error { padding: .3em; }
.validateTips { border: 1px solid transparent; padding: 0.3em }
{% endblock %}

{% block content %}

<div class="panel panel-default">
    <table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>Name</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
    {% for object in queryset %}
        <tr data-pk="{{ object.pk }}">
            <th><a href="
            {% url "cyano-design-design" pk=object.pk %}
            ">{{ object.name }}</a></th>
            <td>
                <a href="{% url "cyano-design-export" pk=object.pk %}" title="Export model"><img src="{% get_static_prefix %}cyano/img/basket_remove.png"/></a>
                <a href="#" class="delete-button" title="Delete model"><img src="{% get_static_prefix %}public/img/delete.png"/></a>
            </td>
        </tr>
    {% endfor %}
    </tbody>
    </table>
</div>

<!-- Button trigger modal -->
<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#dialog-create">
Create new model
</button>

<!-- Modal -->
<div class="modal fade" id="dialog-create" tabindex="-1" role="dialog" aria-labelledby="dialog-create-label"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="dialog-create-label">Create new model</h4>
            </div>
            <div class="modal-body">
                <form method="post" action="{% url "cyano-design-upload" %}" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="dialog-create-name">Model Name</label>
                        <input name="name" class="form-control" id="dialog-create-name" placeholder="Enter model name">
                    </div>
                    <div class="form-group">
                        <label for="dialog-create-file">Model File</label>
                        <input name="file" type="file" id="dialog-create-file">

                        <p class="help-block">Please provide a model in BioOpt format.</p>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="dialog-delete" tabindex="-1" role="dialog" aria-labelledby="dialog-delete-label"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="dialog-delete-label">Delete model</h4>
            </div>
            <div class="modal-body">
                Do you really want to delete the model?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary btn-danger">Delete</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}

